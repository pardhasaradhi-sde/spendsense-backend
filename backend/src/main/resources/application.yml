spring:
  application:
    name: spendsense-api
  profiles:
    active: ${SPRING_PROFILES_ACTIVE}

  #security
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${CLERK_ISSUER_URI}

  #database configuration
  datasource:
    url: ${DATABASE_URL}
    username: ${DATABASE_USERNAME}
    password: ${DATABASE_PASSWORD}
    driver-class-name: org.postgresql.Driver

  #jpa/hibernate Configuration
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: ${SHOW_SQL}
    properties:
      hibernate:
        format-sql: true
        dialect: org.hibernate.dialect.PostgreSQLDialect

  #file upload configuration
  servlet:
    multipart:
      enabled: true
      max-file-size: 10MB
      max-request-size: 10MB
      file-size-threshold: 2MB
      location: ${TEMP_UPLOAD_DIR:./temp}

    # Email Configuration
  mail:
    host: ${MAIL_HOST:smtp.gmail.com}
    port: ${MAIL_PORT:587}
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
          connectiontimeout: 5000
          timeout: 5000
          writetimeout: 5000
    # Cache Configuration
  cache:
    type: caffeine
    caffeine:
      spec: maximumSize=500,expireAfterWrite=24h

  #flyway configuration
  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration

# Gemini AI Configuration
gemini:
  api:
    key: ${GEMINI_API_KEY}
    base-url: https://generativelanguage.googleapis.com/v1beta
    model: gemini-2.5-flash
    vision-model: gemini-2.5-flash
    timeout-seconds: 30
    max-retries: 3
  features:
    insights-enabled: ${AI_INSIGHTS_ENABLED:true}
    receipt-scanning-enabled: ${AI_RECEIPT_SCANNING_ENABLED:true}

# File Storage Configuration
file:
  storage:
    base-dir: ${FILE_STORAGE_DIR:./storage}
    receipts-dir: ${FILE_STORAGE_DIR:./storage}/receipts
    exports-dir: ${FILE_STORAGE_DIR:./storage}/exports
  upload:
    max-size-mb: 10
    allowed-types: image/jpeg,image/png,image/jpg,image/heic,image/webp,application/pdf

clerk:
  webhook-secret: ${CLERK_WEBHOOK_SECRET}

# Scheduling Configuration
scheduling:
  enabled: ${SCHEDULING_ENABLED:true}
  recurring-transactions:
    cron: "0 0 2 * * ?" # Daily at 2 AM
  budget-alerts:
    cron: "0 0 8 * * ?" # Daily at 8 AM
  cleanup:
    cron: "0 0 3 * * SUN" # Weekly on Sunday at 3 AM

# Analytics Configuration
analytics:
  cache-duration-hours: 24
  trends-lookback-days: 90

# Export Configuration
export:
  temp-file-retention-hours: 24
  max-records-per-export: 10000

rate-limit:
  enabled: ${RATE_LIMIT_ENABLED}
  requests-per-minute: ${RATE_LIMIT_RPM}

#server configuration
server:
  port: ${SERVER_PORT}
  servlet:
    context-path: /api/v1

springdoc:
  api-docs:
    path: /api-docs
  swagger-ui:
    path: /swagger-ui.html
    enabled: true

# Logging Configuration
logging:
  level:
    com.spendsense: ${LOG_LEVEL}
    org.hibernate.SQL: ${SQL_LOG_LEVEL}
    org.hibernate.type.descriptor.sql.BasicBinder: ${BINDER_LOG_LEVEL}
